(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(e){if(e.ep)return;e.ep=!0;const a=n(e);fetch(e.href,a)}})();var T={particleCount:100,minRadius:2,maxRadius:6,particleColor:"#000000",lineColor:"#000000",lineWidth:1,lineOpacity:.2,maxDistance:150,moveSpeed:1,backgroundColor:"#ffffff",backgroundOpacity:1,particleOpacity:1,mouseRadius:200,mouseInteraction:!0,pulseEnabled:!0,pulseSpeed:0,depthEffectEnabled:!0,depthSpeed:.02,gradientEnabled:!1,gradientType:"linear",gradientColors:["#667eea","#764ba2"],gradientSpeed:.02,gradientMouseReaction:!0,gradientMouseInfluence:.5,gradientAngle:0,gradientRadius:1,gradientSpin:!1,gradientFlowAngle:45,gradientOrbitRadius:.3,gradientDithering:!0,gradientSmoothStops:4},C={color:"#88ccff",opacity:.6,blur:12,contrast:25,reflectionStrength:.85,highlightPosition:"top-left",highlightColor:"#ffffff",shadowStrength:.4,secondaryReflection:.25,secondaryHighlightPosition:"bottom-right",minRadius:20,maxRadius:40},x=/^#[0-9A-Fa-f]{6}$/;function k(t){return new Promise((s,n)=>{const i=new Image;i.onload=()=>s(i),i.onerror=()=>n(new Error(`Failed to load image: ${t.slice(0,50)}...`)),t.trim().startsWith("<")?i.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t))):i.src=t})}var H=class{constructor(t,s={}){this.particles=[],this.assetImages=new Map,this.assetTintCache=new Map,this.animationId=null,this.isRunning=!1,this.mousePosition=null,this.pulseAngle=0,this.gradientAngle=0,this.gradientFlowOffset=0,this.gradientCenter={x:0,y:0},this.smoothedMouseAngle=0,this.gradientDiv=null,this.childParticleConfigs=new Map,this.overlayContainer=null,this.childOverlayElements=new Map,this.onChildUpdate=null,this.canvas=t;const n=t.getContext("2d",{alpha:!0});if(!n)throw new Error("Could not initialize canvas context");this.ctx=n,this.config=this.validateConfig({...T,...s}),this.createGradientDiv(),this.boundHandleResize=this.handleResize.bind(this),this.boundHandleMouseMove=this.handleMouseMove.bind(this),this.boundHandleMouseLeave=this.handleMouseLeave.bind(this),this.handleResize(),this.createParticles(),this.assignParticleTypes(),this.loadAssets(),this.setupEventListeners()}loadAssets(){const{particleAssets:t,assets:s}=this.config;if(!(t!=null&&t.length)||!s)return;const n=new Set;for(const i of t)n.add(i.asset);for(const i of n){const e=s[i];e&&k(e).then(a=>{this.assetImages.set(i,a)}).catch(()=>{})}}createGradientDiv(){var t;this.gradientDiv=document.createElement("div"),this.gradientDiv.style.cssText="position:fixed;inset:0;width:100%;height:100%;pointer-events:none;z-index:-1;",(t=this.canvas.parentElement)==null||t.insertBefore(this.gradientDiv,this.canvas)}ensureOverlayContainer(){var t;return this.overlayContainer||(this.overlayContainer=document.createElement("div"),this.overlayContainer.style.cssText="position:fixed;inset:0;width:100%;height:100%;pointer-events:none;z-index:1;overflow:hidden;",(t=this.canvas.parentElement)==null||t.appendChild(this.overlayContainer)),this.overlayContainer}getChildOverlayElement(t){let s=this.childOverlayElements.get(t);if(!s){const n=this.ensureOverlayContainer();s=document.createElement("div"),s.style.cssText="position:absolute;pointer-events:auto;display:flex;align-items:center;justify-content:center;will-change:transform;",s.dataset.childParticleId=t,n.appendChild(s),this.childOverlayElements.set(t,s)}return s}removeChildOverlayElement(t){const s=this.childOverlayElements.get(t);s&&(s.remove(),this.childOverlayElements.delete(t))}updateChildOverlays(){for(const t of this.particles){if(!t.isChild||!t.childId)continue;const s=this.childOverlayElements.get(t.childId);if(!s)continue;const n=t.currentRadius??t.radius,i=n*2;s.style.width=i+"px",s.style.height=i+"px",s.style.transform=`translate(${t.x-n}px, ${t.y-n}px)`,s.style.borderRadius="50%"}}validateConfig(t){const s=["particleCount","minRadius","maxRadius","lineWidth","lineOpacity","maxDistance","moveSpeed","backgroundOpacity","particleOpacity","mouseRadius","pulseSpeed","depthSpeed","gradientSpeed","gradientMouseInfluence","gradientAngle","gradientRadius","gradientFlowAngle","gradientOrbitRadius","gradientSmoothStops"];for(const e of s){const a=t[e];if(typeof a!="number"||isNaN(a))throw new Error(`Invalid ${e}: must be a number`)}const n=["mouseInteraction","pulseEnabled","depthEffectEnabled","gradientEnabled","gradientMouseReaction","gradientSpin","gradientDithering"];for(const e of n)if(typeof t[e]!="boolean")throw new Error(`Invalid ${e}: must be a boolean`);const i=["backgroundColor","particleColor","lineColor"];for(const e of i)if(!x.test(t[e]))throw new Error(`Invalid ${e}: must be a valid hex color`);if(t.gradientEnabled){if(!Array.isArray(t.gradientColors)||t.gradientColors.length<2)throw new Error("gradientColors must be an array of at least 2 hex colors");for(const e of t.gradientColors)if(!x.test(e))throw new Error(`Invalid gradient color: ${e} must be valid hex`);if(t.gradientType!=="linear"&&t.gradientType!=="radial")throw new Error("gradientType must be 'linear' or 'radial'");if(t.gradientStops){if(t.gradientStops.length!==t.gradientColors.length)throw new Error("gradientStops length must match gradientColors length");for(let e=0;e<t.gradientStops.length;e++){const a=t.gradientStops[e];if(typeof a!="number"||a<0||a>1)throw new Error(`gradientStops[${e}] must be a number 0-1`);if(e>0&&a<=t.gradientStops[e-1])throw new Error("gradientStops must be strictly increasing")}}}if(t.particleAssets&&t.particleAssets.length>0){if(!t.assets||typeof t.assets!="object")throw new Error("assets map is required when using particleAssets");for(let e=0;e<t.particleAssets.length;e++){const a=t.particleAssets[e];if(typeof a.asset!="string"||!a.asset)throw new Error(`particleAssets[${e}].asset must be a non-empty string`);const o=a.count!==void 0,r=a.percentage!==void 0;if(o===r)throw new Error(`particleAssets[${e}]: specify exactly one of count or percentage`);if(o&&(typeof a.count!="number"||a.count<0))throw new Error(`particleAssets[${e}].count must be a non-negative number`);if(r&&(typeof a.percentage!="number"||a.percentage<0||a.percentage>100))throw new Error(`particleAssets[${e}].percentage must be 0-100`);if(!t.assets[a.asset])throw new Error(`particleAssets[${e}]: asset "${a.asset}" not found in assets map`)}}if(t.assetColor!=null&&!x.test(t.assetColor))throw new Error("assetColor must be a valid hex color");if(t.assetOpacity!=null&&(typeof t.assetOpacity!="number"||t.assetOpacity<0||t.assetOpacity>1))throw new Error("assetOpacity must be a number 0-1");if(t.mouseAttractPercentage!=null&&(typeof t.mouseAttractPercentage!="number"||t.mouseAttractPercentage<0||t.mouseAttractPercentage>100))throw new Error("mouseAttractPercentage must be 0-100");if(t.mouseAttractAssets!=null&&(!Array.isArray(t.mouseAttractAssets)||t.mouseAttractAssets.some(e=>typeof e!="string")))throw new Error("mouseAttractAssets must be an array of strings");if(t.minParticleDistance!=null&&(typeof t.minParticleDistance!="number"||t.minParticleDistance<0))throw new Error("minParticleDistance must be a non-negative number");if(t.minParticleForce!=null&&(typeof t.minParticleForce!="number"||t.minParticleForce<0||t.minParticleForce>2))throw new Error("minParticleForce must be 0-2");if(t.connectionRules!=null){const{allow:e,deny:a}=t.connectionRules,o=(r,l)=>{if(!Array.isArray(r))throw new Error(`connectionRules.${l} must be an array`);for(let u=0;u<r.length;u++){const d=r[u];if(!Array.isArray(d)||d.length!==2||typeof d[0]!="string"||typeof d[1]!="string")throw new Error(`connectionRules.${l}[${u}] must be [string, string]`)}};e!=null&&o(e,"allow"),a!=null&&o(a,"deny")}if(t.particleTypes!=null){if(!Array.isArray(t.particleTypes))throw new Error("particleTypes must be an array");if(!t.assets||typeof t.assets!="object")throw new Error("assets map is required when using particleTypes with asset entries");for(let e=0;e<t.particleTypes.length;e++){const a=t.particleTypes[e];if(!a||typeof a.type!="string")throw new Error(`particleTypes[${e}].type must be "circle", "asset", or "liquidGlass"`);if(a.type!=="circle"&&a.type!=="asset"&&a.type!=="liquidGlass")throw new Error(`particleTypes[${e}].type must be "circle", "asset", or "liquidGlass"`);const o=a.count!==void 0,r=a.percentage!==void 0;if(o===r)throw new Error(`particleTypes[${e}]: specify exactly one of count or percentage`);if(a.type==="asset"){if(typeof a.asset!="string"||!a.asset)throw new Error(`particleTypes[${e}].asset must be a non-empty string`);if(!t.assets[a.asset])throw new Error(`particleTypes[${e}]: asset "${a.asset}" not found in assets`)}}}if(t.liquidGlass!=null){const e=t.liquidGlass;if(e.color!=null&&!x.test(e.color))throw new Error("liquidGlass.color must be a valid hex color");if(e.opacity!=null&&(typeof e.opacity!="number"||e.opacity<0||e.opacity>1))throw new Error("liquidGlass.opacity must be 0-1");if(e.blur!=null&&(typeof e.blur!="number"||e.blur<0))throw new Error("liquidGlass.blur must be a non-negative number");if(e.contrast!=null&&(typeof e.contrast!="number"||e.contrast<1))throw new Error("liquidGlass.contrast must be >= 1");if(e.highlightColor!=null&&!x.test(e.highlightColor))throw new Error("liquidGlass.highlightColor must be a valid hex color");if(e.minRadius!=null&&(typeof e.minRadius!="number"||e.minRadius<=0))throw new Error("liquidGlass.minRadius must be a positive number");if(e.maxRadius!=null&&(typeof e.maxRadius!="number"||e.maxRadius<=0))throw new Error("liquidGlass.maxRadius must be a positive number")}if(t.liquidGlassPercentage!=null&&(typeof t.liquidGlassPercentage!="number"||t.liquidGlassPercentage<0||t.liquidGlassPercentage>100))throw new Error("liquidGlassPercentage must be 0-100");if(t.liquidGlassCount!=null&&(typeof t.liquidGlassCount!="number"||t.liquidGlassCount<0))throw new Error("liquidGlassCount must be a non-negative number");return t}setupEventListeners(){window.addEventListener("resize",this.boundHandleResize),this.canvas.addEventListener("mousemove",this.boundHandleMouseMove),this.canvas.addEventListener("mouseleave",this.boundHandleMouseLeave)}cleanup(){var t,s;window.removeEventListener("resize",this.boundHandleResize),this.canvas.removeEventListener("mousemove",this.boundHandleMouseMove),this.canvas.removeEventListener("mouseleave",this.boundHandleMouseLeave),(t=this.gradientDiv)==null||t.remove(),this.gradientDiv=null,(s=this.overlayContainer)==null||s.remove(),this.overlayContainer=null,this.childOverlayElements.clear(),this.childParticleConfigs.clear(),this.stop()}handleMouseMove(t){const s=this.canvas.getBoundingClientRect();this.mousePosition={x:t.clientX-s.left,y:t.clientY-s.top}}handleMouseLeave(){this.mousePosition=null}handleResize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.gradientCenter={x:this.canvas.width/2,y:this.canvas.height/2}}createParticles(){const t=this.particles.filter(n=>n.isChild);this.particles=[];const s=this.config.particleCount;for(let n=0;n<s;n++){const i=this.config.maxRadius-this.config.minRadius,e=Math.random()*i+this.config.minRadius;this.particles.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,dx:(Math.random()-.5)*this.config.moveSpeed,dy:(Math.random()-.5)*this.config.moveSpeed,radius:e,z:Math.random(),dz:(Math.random()-.5)*this.config.depthSpeed*2})}this.assignParticleTypes(),this.particles.push(...t)}assignParticleTypes(){const{particleTypes:t,particleAssets:s,particleCount:n}=this.config;if(this.particles.forEach(i=>{delete i.assetId,delete i.liquidGlass}),t!=null&&t.length){const i=[];for(const o of t){let r;o.count!==void 0?r=Math.floor(o.count):r=Math.floor(n*(o.percentage??0)/100),r>0&&(o.type==="circle"?i.push({liquidGlass:!1,count:r}):o.type==="asset"?i.push({assetId:o.asset,liquidGlass:o.liquidGlass??!1,count:r}):i.push({liquidGlass:!0,count:r}))}const e=[];for(let o=0;o<n;o++)e.push(o);for(let o=e.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[e[o],e[r]]=[e[r],e[o]]}let a=0;for(const{assetId:o,liquidGlass:r,count:l}of i)for(let u=0;u<l&&a<e.length;u++,a++){const d=this.particles[e[a]];o&&(d.assetId=o),d.liquidGlass=r,r&&this.resizeAsLiquidGlass(d)}}else if(s!=null&&s.length){const i=[];for(const o of s){let r;o.count!==void 0?r=Math.floor(o.count):r=Math.floor(n*(o.percentage??0)/100),r>0&&i.push({assetId:o.asset,count:r})}const e=[];for(let o=0;o<n;o++)e.push(o);for(let o=e.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[e[o],e[r]]=[e[r],e[o]]}let a=0;for(const{assetId:o,count:r}of i)for(let l=0;l<r&&a<e.length;l++,a++)this.particles[e[a]].assetId=o}!(t!=null&&t.length)&&(this.config.liquidGlassPercentage!=null||this.config.liquidGlassCount!=null)&&this.assignLiquidGlass(),this.assignMouseBehavior()}assignLiquidGlass(){const{liquidGlassPercentage:t,liquidGlassCount:s,particleCount:n}=this.config;this.particles.forEach(a=>a.liquidGlass=!1);let i=0;if(s!=null&&s>0?i=Math.min(Math.floor(s),n):t!=null&&t>0&&(i=Math.floor(n*Math.min(100,Math.max(0,t))/100)),i<=0)return;const e=[];for(let a=0;a<n;a++)e.push(a);for(let a=e.length-1;a>0;a--){const o=Math.floor(Math.random()*(a+1));[e[a],e[o]]=[e[o],e[a]]}for(let a=0;a<i&&a<e.length;a++){const o=this.particles[e[a]];o.liquidGlass=!0,this.resizeAsLiquidGlass(o)}}resizeAsLiquidGlass(t){const s=this.getLiquidGlassConfig(),n=s.minRadius??C.minRadius,i=s.maxRadius??C.maxRadius;t.radius=Math.random()*(i-n)+n,delete t.currentRadius,this.initBlob(t)}initBlob(t){const i=[],e=[],a=[],o=[];for(let l=0;l<3;l++)i.push(2+l),e.push((.03+Math.random()*.03)/(1+l*.4)),a.push(Math.random()*Math.PI*2),o.push((.006+Math.random()*.01)*(Math.random()>.5?1:-1));const r=Math.random()*Math.PI*2;t.blob={pointCount:12,freqs:i,amps:e,phases:a,phaseSpeeds:o,rotSpeed:(Math.random()>.5?1:-1)*(.001+Math.random()*.003),rotation:Math.random()*Math.PI*2,hlAngle:r,hlAngleSpeed:(.002+Math.random()*.004)*(Math.random()>.5?1:-1),mouseStretchX:0,mouseStretchY:0}}assignMouseBehavior(){const{mouseAttractPercentage:t,mouseAttractAssets:s,particleCount:n}=this.config;this.particles.forEach(e=>e.mouseAttract=!1);const i=new Set(s??[]);if(i.size>0&&this.particles.forEach(e=>{e.assetId&&i.has(e.assetId)&&(e.mouseAttract=!0)}),t!=null&&t>0){const e=Math.floor(n*Math.min(100,Math.max(0,t))/100),a=[];for(let o=0;o<n;o++)a.push(o);for(let o=a.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[a[o],a[r]]=[a[r],a[o]]}for(let o=0;o<e&&o<a.length;o++)this.particles[a[o]].mouseAttract=!0}}updateParticles(){this.particles.forEach(t=>{if(this.config.depthEffectEnabled&&(t.z+=t.dz,t.z<=0?(t.z=0,t.dz=Math.abs(t.dz)):t.z>=1&&(t.z=1,t.dz=-Math.abs(t.dz))),this.config.pulseEnabled){this.pulseAngle+=this.config.pulseSpeed;const i=Math.sin(this.pulseAngle)*.5+1;t.currentRadius=t.radius*i}else t.currentRadius=t.radius;if(this.config.depthEffectEnabled){const i=.4+.6*t.z;t.currentRadius=(t.currentRadius??t.radius)*i}if(t.x+=t.dx,t.y+=t.dy,this.config.mouseInteraction&&this.mousePosition){const i=this.mousePosition.x-t.x,e=this.mousePosition.y-t.y,a=Math.sqrt(i*i+e*e);if(a<this.config.mouseRadius){const o=(this.config.mouseRadius-a)/this.config.mouseRadius,r=Math.atan2(e,i),l=t.isChild?t.mouseInfluence??.1:1,u=Math.cos(r)*o*.5*l,d=Math.sin(r)*o*.5*l;t.mouseAttract?(t.dx+=u,t.dy+=d):(t.dx-=u,t.dy-=d)}}if(t.isChild&&t.anchorX!=null&&t.anchorY!=null){const i=t.anchorForce??.05,e=t.anchorX-t.x,a=t.anchorY-t.y;t.dx+=e*i,t.dy+=a*i,t.dx*=.92,t.dy*=.92}const s=this.config.minParticleDistance??0,n=this.config.minParticleForce??.5;if(s>0&&n>0){const i=t.currentRadius??t.radius;for(const e of this.particles){if(e===t)continue;const a=e.x-t.x,o=e.y-t.y,r=Math.sqrt(a*a+o*o),l=e.currentRadius??e.radius,u=r-i-l;if(u<s&&r>.001){const d=(s-u)/s*n,h=-a/r,g=-o/r;t.dx+=h*d,t.dy+=g*d}}}if(t.isChild||((t.x<0||t.x>this.canvas.width)&&(t.dx=-t.dx),(t.y<0||t.y>this.canvas.height)&&(t.dy=-t.dy)),!t.isChild){const i=Math.sqrt(t.dx*t.dx+t.dy*t.dy);i>this.config.moveSpeed&&(t.dx=t.dx/i*this.config.moveSpeed,t.dy=t.dy/i*this.config.moveSpeed)}})}getLiquidGlassConfig(){return{...C,...this.config.liquidGlass}}getHighlightOffset(t,s){switch(t){case"top-left":return{x:s*-.35,y:s*-.35};case"top":return{x:0,y:s*-.4};case"top-right":return{x:s*.35,y:s*-.35};case"bottom-right":return{x:s*.3,y:s*.3};case"center":default:return{x:s*-.2,y:s*-.2}}}traceBlobPath(t,s,n,i){const e=i.pointCount,a=i.mouseStretchX,o=i.mouseStretchY,r=[];for(let d=0;d<e;d++){const h=d/e*Math.PI*2,g=h+i.rotation;let p=0;for(let v=0;v<i.freqs.length;v++)p+=i.amps[v]*Math.sin(i.freqs[v]*g+i.phases[v]);const I=n*(1+p);let A=t+Math.cos(h)*I,S=s+Math.sin(h)*I;A+=a*Math.cos(h)*Math.max(0,Math.cos(h)),S+=o*Math.sin(h)*Math.max(0,Math.sin(h)),r.push({x:A,y:S})}this.ctx.beginPath();const l=r[e-1],u=r[0];this.ctx.moveTo((l.x+u.x)/2,(l.y+u.y)/2);for(let d=0;d<e;d++){const h=r[(d+1)%e];this.ctx.quadraticCurveTo(r[d].x,r[d].y,(r[d].x+h.x)/2,(r[d].y+h.y)/2)}this.ctx.closePath()}updateBlobMouse(t){const s=t.blob;if(!s)return;const n=t.currentRadius??t.radius,i=.08;if(this.config.mouseInteraction&&this.mousePosition){const e=this.mousePosition.x-t.x,a=this.mousePosition.y-t.y,o=Math.sqrt(e*e+a*a),r=this.config.mouseRadius;if(o<r&&o>.01){const u=(r-o)/r*n*.4,d=e/o,h=a/o,g=d*u,p=h*u;s.mouseStretchX+=(g-s.mouseStretchX)*i,s.mouseStretchY+=(p-s.mouseStretchY)*i;return}}s.mouseStretchX*=1-i,s.mouseStretchY*=1-i}draw3DFluidSphere(t){const s=this.getLiquidGlassConfig(),n=t.currentRadius??t.radius;if(n<=0)return;t.blob||this.initBlob(t);const i=t.blob,e=t.x,a=t.y;let o=(s.opacity??C.opacity)*this.config.particleOpacity;if(this.config.depthEffectEnabled&&(o*=.6+.4*t.z),o<=0)return;i.rotation+=i.rotSpeed;for(let R=0;R<i.phases.length;R++)i.phases[R]+=i.phaseSpeeds[R];i.hlAngle+=i.hlAngleSpeed,this.updateBlobMouse(t);const r=s.color??C.color,l=parseInt(r.slice(1,3),16),u=parseInt(r.slice(3,5),16),d=parseInt(r.slice(5,7),16),h=s.shadowStrength??C.shadowStrength,g=n*.35,p=e+Math.cos(i.hlAngle)*g,I=a+Math.sin(i.hlAngle)*g,A=Math.min(255,l+Math.round((255-l)*.55)),S=Math.min(255,u+Math.round((255-u)*.55)),v=Math.min(255,d+Math.round((255-d)*.55)),q=Math.max(0,Math.round(l*(1-h*.35))),B=Math.max(0,Math.round(u*(1-h*.35))),G=Math.max(0,Math.round(d*(1-h*.35)));this.ctx.save();const b=this.ctx.createRadialGradient(p,I,n*.05,e,a,n*1.05);b.addColorStop(0,`rgba(${A},${S},${v}, ${o*.95})`),b.addColorStop(.4,`rgba(${l},${u},${d}, ${o*.8})`),b.addColorStop(.8,`rgba(${q},${B},${G}, ${o*.6})`),b.addColorStop(1,`rgba(${q},${B},${G}, ${o*.25})`),this.ctx.fillStyle=b,this.traceBlobPath(e,a,n,i),this.ctx.fill(),this.ctx.restore()}getTintedCanvas(t,s){const n=`${t.src}_${s}`,i=this.assetTintCache.get(n);if(i)return i;const e=128,a=document.createElement("canvas");a.width=e,a.height=e;const o=a.getContext("2d");return o.fillStyle=s,o.fillRect(0,0,e,e),o.globalCompositeOperation="destination-in",o.drawImage(t,0,0,e,e),this.assetTintCache.set(n,a),a}drawParticles(){const t=this.config.particleColor,s=this.config.assetColor,n=this.config.assetOpacity??1;this.particles.forEach(i=>{if(i.liquidGlass){this.draw3DFluidSphere(i);return}let e=this.config.particleOpacity;this.config.depthEffectEnabled&&(e*=.6+.4*i.z);const a=i.currentRadius??i.radius,o=i.assetId?this.assetImages.get(i.assetId):null;if(o){this.ctx.globalAlpha=e*n;const r=a*2,l=i.x-a,u=i.y-a;s&&x.test(s)?this.ctx.drawImage(this.getTintedCanvas(o,s),l,u,r,r):this.ctx.drawImage(o,l,u,r,r)}else this.ctx.globalAlpha=e,this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(i.x,i.y,a,0,Math.PI*2),this.ctx.fill()}),this.ctx.globalAlpha=1}getCategory(t){return t.assetId??"default"}canConnect(t,s){var o;const n=this.config.connectionRules;if(!n)return!0;const i=this.getCategory(t),e=this.getCategory(s),a=[i,e].sort().join("|");return(o=n.deny)!=null&&o.length&&n.deny.some(([l,u])=>[l,u].sort().join("|")===a)?!1:n.allow&&n.allow.length>0?n.allow.some(([r,l])=>[r,l].sort().join("|")===a):!0}drawConnections(){for(let t=0;t<this.particles.length;t++)for(let s=t+1;s<this.particles.length;s++){const n=this.particles[t].x-this.particles[s].x,i=this.particles[t].y-this.particles[s].y,e=Math.sqrt(n*n+i*i);if(e<this.config.maxDistance&&this.canConnect(this.particles[t],this.particles[s])){const a=1-e/this.config.maxDistance,o=this.hexToRgb(this.config.lineColor);this.ctx.beginPath(),this.ctx.strokeStyle=`rgba(${o}, ${a*this.config.lineOpacity})`,this.ctx.lineWidth=this.config.lineWidth,this.ctx.moveTo(this.particles[t].x,this.particles[t].y),this.ctx.lineTo(this.particles[s].x,this.particles[s].y),this.ctx.stroke()}}}drawBackground(){this.config.gradientEnabled&&this.gradientDiv?(this.gradientDiv.style.display="",this.gradientDiv.style.opacity=String(this.config.backgroundOpacity),this.updateGradientCSS(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):(this.gradientDiv&&(this.gradientDiv.style.display="none"),this.ctx.globalAlpha=this.config.backgroundOpacity,this.ctx.fillStyle=this.config.backgroundColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.globalAlpha=1)}updateGradientCSS(){if(!this.gradientDiv)return;const t=this.canvas.width,s=this.canvas.height,n=this.config.gradientColors;if(this.config.gradientType==="linear")if(this.config.gradientSpin){this.gradientAngle+=this.config.gradientSpeed;const i=this.gradientAngle*180/Math.PI;this.gradientDiv.style.background=`linear-gradient(${i}deg, ${n.join(", ")})`,this.gradientDiv.style.backgroundSize="",this.gradientDiv.style.backgroundPosition=""}else{const i=this.config.gradientFlowAngle,e=[...n,...n,...n,n[0]];this.gradientDiv.style.background=`linear-gradient(${i}deg, ${e.join(", ")})`,this.gradientDiv.style.backgroundSize="300% 300%",this.gradientFlowOffset=(this.gradientFlowOffset+this.config.gradientSpeed*.5)%100;const a=this.gradientFlowOffset;this.gradientDiv.style.backgroundPosition=`${a}% ${a}%`}else{const i=t/2,e=s/2,a=Math.min(t,s)*this.config.gradientOrbitRadius;this.gradientAngle+=this.config.gradientSpeed;let o=i+Math.cos(this.gradientAngle)*a,r=e+Math.sin(this.gradientAngle)*a;if(this.config.gradientMouseReaction&&this.mousePosition){const g=this.config.gradientMouseInfluence;o+=(this.mousePosition.x-o)*g,r+=(this.mousePosition.y-r)*g}this.gradientCenter.x+=(o-this.gradientCenter.x)*.03,this.gradientCenter.y+=(r-this.gradientCenter.y)*.03;const l=Math.max(t,s)*this.config.gradientRadius,u=[...n,...n,n[0]],d=l*2/(u.length-1),h=u.map((g,p)=>`${g} ${p*d}px`).join(", ");this.gradientDiv.style.background=`radial-gradient(circle at ${this.gradientCenter.x}px ${this.gradientCenter.y}px, ${h})`,this.gradientDiv.style.backgroundSize="",this.gradientDiv.style.backgroundPosition=""}}hexToRgb(t){t=t.replace(/^#/,""),t.length===3&&(t=t.split("").map(n=>n+n).join(""));const s=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return s?s.slice(1).map(n=>parseInt(n,16)).join(","):"255,255,255"}addChildParticle(t){this.childParticleConfigs.has(t.id)&&this.removeChildParticle(t.id),this.childParticleConfigs.set(t.id,t);const s={x:t.x,y:t.y,dx:0,dy:0,radius:t.radius,z:.8+Math.random()*.2,dz:(Math.random()-.5)*this.config.depthSpeed*2,isChild:!0,childId:t.id,anchorX:t.x,anchorY:t.y,anchorForce:t.anchorForce??.05,mouseInfluence:t.mouseInfluence??.1};t.liquidGlass&&(s.liquidGlass=!0,this.initBlob(s)),this.particles.push(s)}removeChildParticle(t){this.childParticleConfigs.delete(t),this.removeChildOverlayElement(t);const s=this.particles.findIndex(n=>n.childId===t);s!==-1&&this.particles.splice(s,1)}updateChildParticle(t,s){const n=this.childParticleConfigs.get(t);if(!n)return;Object.assign(n,s);const i=this.particles.find(e=>e.childId===t);i&&(s.x!==void 0&&(i.anchorX=s.x),s.y!==void 0&&(i.anchorY=s.y),s.radius!==void 0&&(i.radius=s.radius),s.anchorForce!==void 0&&(i.anchorForce=s.anchorForce),s.mouseInfluence!==void 0&&(i.mouseInfluence=s.mouseInfluence),s.liquidGlass!==void 0&&(i.liquidGlass=s.liquidGlass,s.liquidGlass&&!i.blob&&this.initBlob(i)))}getChildParticlePositions(){var s;const t=new Map;for(const n of this.particles)!n.isChild||!n.childId||t.set(n.childId,{x:n.x,y:n.y,radius:n.radius,currentRadius:n.currentRadius??n.radius,rotation:((s=n.blob)==null?void 0:s.rotation)??0});return t}stop(){this.isRunning=!1,this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null)}start(){this.isRunning||(this.isRunning=!0,this.animate())}animate(){this.drawBackground(),this.updateParticles(),this.drawParticles(),this.drawConnections(),this.childParticleConfigs.size>0&&(this.updateChildOverlays(),this.onChildUpdate&&this.onChildUpdate(this.getChildParticlePositions())),this.isRunning&&(this.animationId=requestAnimationFrame(()=>this.animate()))}updateConfig(t,s){var n;this.config[t]=s,t==="particleCount"&&this.createParticles(),(t==="particleAssets"||t==="assets"||t==="particleTypes")&&(this.assetImages.clear(),this.assetTintCache.clear(),this.loadAssets(),this.assignParticleTypes()),(t==="liquidGlassPercentage"||t==="liquidGlassCount")&&((n=this.config.particleTypes)!=null&&n.length||this.assignLiquidGlass()),(t==="mouseAttractPercentage"||t==="mouseAttractAssets")&&this.assignMouseBehavior(),t==="assetColor"&&this.assetTintCache.clear(),t==="moveSpeed"&&this.particles.forEach(i=>{const e=Math.sqrt(i.dx*i.dx+i.dy*i.dy);e>0&&(i.dx=i.dx/e*s,i.dy=i.dy/e*s)}),(t==="minRadius"||t==="maxRadius")&&this.particles.forEach(i=>{const e=this.config.maxRadius-this.config.minRadius,a=Math.random()*e+this.config.minRadius;i.radius=a}),t==="depthSpeed"&&this.particles.forEach(i=>{const e=i.dz>=0?1:-1;i.dz=e*(Math.random()*.5+.5)*s*2})}reset(t){this.config=this.validateConfig({...T,...t}),this.assetImages.clear(),this.assetTintCache.clear(),this.createParticles(),this.loadAssets(),this.stop(),this.start()}};const j=["star","heart","circle","bolt","fire","snowflake","leaf","sun","moon","cloud","gem","diamond","crown","music"],U="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/svgs",f={particleCount:100,minRadius:2,maxRadius:6,particleColor:"#a1a1aa",lineColor:"#71717a",lineWidth:1,lineOpacity:.2,maxDistance:150,moveSpeed:1,backgroundColor:"#0f0f14",backgroundOpacity:1,particleOpacity:1,mouseRadius:200,minParticleDistance:0,minParticleForce:.5,mouseInteraction:!0,pulseEnabled:!0,pulseSpeed:0,depthEffectEnabled:!0,depthSpeed:.02,gradientEnabled:!0,gradientType:"linear",gradientColors:["#667eea","#764ba2","#f093fb"],gradientSpeed:.02,gradientMouseReaction:!0,gradientMouseInfluence:.5,gradientAngle:0,gradientRadius:1,gradientSpin:!1,gradientDithering:!0,gradientSmoothStops:4,gradientFlowAngle:45,gradientOrbitRadius:.3},N=document.getElementById("canvas"),c=new H(N,{...f});c.start();const w=document.getElementById("controlToggle"),M=document.querySelector(".control-panel"),X=document.querySelector(".close-panel");w.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),M.classList.toggle("active"),w.classList.toggle("active")});X.addEventListener("click",()=>{M.classList.remove("active"),w.classList.remove("active")});document.addEventListener("click",t=>{!M.contains(t.target)&&!w.contains(t.target)&&(M.classList.remove("active"),w.classList.remove("active"))});M.addEventListener("click",t=>t.stopPropagation());function y(t){if(t.parentElement.querySelectorAll(".value-display").forEach(n=>{var i;if(!(n.dataset.for&&n.dataset.for!==t.id)&&!n.dataset.for&&t.id!=="minRadius"&&t.id!=="maxRadius"){let e=t.value;t.type==="range"&&(t.id.includes("Opacity")?e=Math.round(e)+"%":t.id==="pulseSpeed"?e=Math.round(e/.2*100)+"%":t.id==="gradientFlowAngle"?e=Math.round(parseFloat(e))+"°":e=parseFloat(e).toFixed((i=t.step)!=null&&i.includes(".")?3:0)),n.textContent=e}}),t.id==="minRadius"||t.id==="maxRadius"){const n=t.parentElement.querySelector('[data-for="minRadius"]'),i=t.parentElement.querySelector('[data-for="maxRadius"]');n&&(n.textContent=document.getElementById("minRadius").value),i&&(i.textContent=document.getElementById("maxRadius").value)}}function L(t){return t=t.replace(/^#/,""),t.length===3||t.length===6?"#"+t:null}function O(t,s,n){const i=t.value,e=parseInt((s==null?void 0:s.value)||100)/100;n==="backgroundColor"?(c.updateConfig("backgroundColor",i),c.updateConfig("backgroundOpacity",e)):n==="particleColor"?(c.updateConfig("particleColor",i),c.updateConfig("particleOpacity",e)):n==="lineColor"&&(c.updateConfig("lineColor",i),c.updateConfig("lineOpacity",e))}[{color:"backgroundColor",hex:"backgroundHex",opacity:"backgroundOpacity"},{color:"particleColor",hex:"particleHex",opacity:"particleOpacity"},{color:"lineColor",hex:"lineHex",opacity:"lineOpacity"}].forEach(({color:t,hex:s,opacity:n})=>{const i=document.getElementById(t),e=document.getElementById(s),a=document.getElementById(n);i.addEventListener("input",()=>{e.value=i.value.toUpperCase(),O(i,a,t)}),e.addEventListener("input",o=>{const r=L(o.target.value);r&&(i.value=r,e.value=r.toUpperCase(),O(i,a,t))}),a.addEventListener("input",()=>{y(a),O(i,a,t)}),e.addEventListener("blur",()=>{const o=L(e.value);e.value=o?o.toUpperCase():i.value.toUpperCase()})});var F;(F=document.getElementById("mouseAttractPercentage"))==null||F.addEventListener("input",t=>{const s=parseInt(t.target.value);t.target.parentElement.querySelector(".value-display").textContent=s+"%",c.updateConfig("mouseAttractPercentage",s)});document.querySelectorAll("input").forEach(t=>{t.id.includes("Color")||t.id.includes("Hex")||t.id.includes("Opacity")||t.id.startsWith("gradientColor")||t.id!=="gradientType"&&t.id!=="mouseAttractPercentage"&&t.addEventListener("input",s=>{let n=s.target.value;(s.target.type==="range"||s.target.type==="number")&&(n=parseFloat(n)),s.target.type==="checkbox"&&(n=s.target.checked),y(s.target);const i=s.target.id;i in f&&c.updateConfig(i,n)})});function D(t){const s=t==="radial";document.getElementById("gradientMouseReactionRow").style.display=s?"":"none",document.getElementById("gradientMouseInfluenceRow").style.display=s?"":"none"}document.getElementById("gradientType").addEventListener("change",t=>{c.updateConfig("gradientType",t.target.value),D(t.target.value)});document.getElementById("gradientFlowAngle").addEventListener("input",t=>{const s=parseFloat(t.target.value);y(t.target),c.updateConfig("gradientFlowAngle",s)});function $(){const t=document.getElementById("gradientColorsContainer"),s=c.config.gradientColors;t.innerHTML="",s.forEach((i,e)=>{const a=document.createElement("div");a.className="gradient-color-item";const o=document.createElement("input");o.type="color",o.value=i,o.dataset.index=String(e);const r=document.createElement("button");r.type="button",r.className="gradient-color-remove",r.textContent="−",r.dataset.index=String(e),r.disabled=s.length<=2,r.setAttribute("aria-label","Remove color"),a.appendChild(o),a.appendChild(r),t.appendChild(a)});const n=document.createElement("button");n.type="button",n.className="gradient-color-add",n.textContent="+",n.setAttribute("aria-label","Add color"),t.appendChild(n)}$();document.getElementById("gradientColorsContainer").addEventListener("input",t=>{if(t.target.type==="color"&&t.target.dataset.index!=null){const s=parseInt(t.target.dataset.index,10),n=[...c.config.gradientColors];n[s]=t.target.value,c.updateConfig("gradientColors",n)}});document.getElementById("gradientColorsContainer").addEventListener("click",t=>{if(t.target.classList.contains("gradient-color-remove")&&!t.target.disabled){const s=parseInt(t.target.dataset.index,10),n=[...c.config.gradientColors];n.length>2&&(n.splice(s,1),c.updateConfig("gradientColors",n),$())}if(t.target.classList.contains("gradient-color-add")){const s=[...c.config.gradientColors,"#667eea"];c.updateConfig("gradientColors",s),$()}});let m=[];function Y(){const t={},s=[];for(const n of m){let i=null,e;if(n.source==="fa"&&n.faIcon){const a=n.faStyle||"solid";e=`fa_${a}_${n.faIcon}`,i=`${U}/${a}/${n.faIcon}.svg`}else n.source==="file"&&n.fileUrl&&(e=`file_${n.id}`,i=n.fileUrl);i&&(t[e]=i,s.push(n.mode==="count"?{asset:e,count:Math.max(0,Math.floor(n.value))}:{asset:e,percentage:Math.max(0,Math.min(100,n.value))}))}return{assets:t,particleAssets:s}}function P(){const{assets:t,particleAssets:s}=Y();Object.keys(t).length>0?(c.updateConfig("assets",t),c.updateConfig("particleAssets",s)):(c.updateConfig("assets",void 0),c.updateConfig("particleAssets",void 0)),z()}function z(){const t=document.getElementById("mouseAttractAssetsRow"),s=document.getElementById("mouseAttractAssetsContainer"),n=c.config.assets,i=n?Object.keys(n):[];if(i.length===0){t.style.display="none",s.innerHTML="";return}t.style.display="",s.innerHTML="";const e=c.config.mouseAttractAssets??[];i.forEach(a=>{const o=document.createElement("label");o.className="toggle",o.style.cursor="pointer";const r=document.createElement("input");r.type="checkbox",r.value=a,r.checked=e.includes(a),r.addEventListener("change",()=>{const u=c.config.mouseAttractAssets??[],d=r.checked?[...u,a]:u.filter(h=>h!==a);c.updateConfig("mouseAttractAssets",d.length?d:void 0)});const l=document.createElement("span");l.className="toggle-label",l.textContent=a,o.appendChild(r),o.appendChild(l),s.appendChild(o)})}function E(){const t=document.getElementById("assetColorControls");t.style.display=m.length>0?"block":"none";const s=document.getElementById("assetEntriesContainer");s.innerHTML="",m.forEach(n=>{const i=document.createElement("div");i.className="asset-entry",i.dataset.id=n.id;const e=n.source==="fa"?`Font Awesome: ${n.faIcon}`:n.fileName||"File";i.innerHTML=`
      <div class="asset-entry-header">
        <span style="font-size:0.75rem;color:var(--text-muted)">${e}</span>
        <button type="button" class="asset-remove" data-id="${n.id}" aria-label="Remove">×</button>
      </div>
      <div class="asset-entry-source">
        <select data-field="source" data-id="${n.id}">
          <option value="fa" ${n.source==="fa"?"selected":""}>Font Awesome</option>
          <option value="file" ${n.source==="file"?"selected":""}>Upload PNG/SVG</option>
        </select>
        ${n.source==="fa"?`
          <select data-field="faStyle" data-id="${n.id}">
            <option value="solid" ${(n.faStyle||"solid")==="solid"?"selected":""}>Solid</option>
            <option value="regular" ${n.faStyle==="regular"?"selected":""}>Regular</option>
          </select>
          <select data-field="faIcon" data-id="${n.id}">
            ${j.map(a=>`<option value="${a}" ${n.faIcon===a?"selected":""}>${a}</option>`).join("")}
          </select>
        `:`
          <input type="file" data-id="${n.id}" accept="image/png,image/svg+xml,image/jpeg,image/webp" style="font-size:0.75rem;color:var(--text-muted)">
        `}
      </div>
      <div class="asset-entry-mode">
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer">
          <input type="radio" name="mode-${n.id}" value="count" ${n.mode==="count"?"checked":""}>
          <span style="font-size:0.8rem">Count</span>
        </label>
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer">
          <input type="radio" name="mode-${n.id}" value="percentage" ${n.mode==="percentage"?"checked":""}>
          <span style="font-size:0.8rem">%</span>
        </label>
        <input type="number" data-field="value" data-id="${n.id}" value="${n.value}" min="0" max="${n.mode==="percentage"?100:999}">
      </div>
    `,s.appendChild(i)})}function _(){const t=document.getElementById("assetEntriesContainer");t.addEventListener("change",s=>{var e,a,o,r,l,u,d;const n=(e=s.target.dataset)==null?void 0:e.id;if(!n)return;const i=m.find(h=>h.id===n);if(i){if(((a=s.target.dataset)==null?void 0:a.field)==="source")i.source=s.target.value,i.source==="file"&&(i.fileUrl=null),E();else if(((o=s.target.dataset)==null?void 0:o.field)==="faStyle")i.faStyle=s.target.value;else if(((r=s.target.dataset)==null?void 0:r.field)==="faIcon")i.faIcon=s.target.value;else if(((l=s.target.dataset)==null?void 0:l.field)==="value")i.value=parseFloat(s.target.value)||0;else if(s.target.type==="radio"&&((u=s.target.name)!=null&&u.startsWith("mode-")))i.mode=s.target.value;else if(s.target.type==="file"&&((d=s.target.files)!=null&&d[0])){const h=s.target.files[0];i.fileUrl=URL.createObjectURL(h),i.fileName=h.name,E()}P()}}),t.addEventListener("input",s=>{var n;if(((n=s.target.dataset)==null?void 0:n.field)==="value"){const i=s.target.dataset.id,e=m.find(a=>a.id===i);e&&(e.value=parseFloat(s.target.value)||0,P())}}),t.addEventListener("click",s=>{if(s.target.classList.contains("asset-remove")){const n=s.target.dataset.id;m=m.filter(i=>i.id!==n),E(),P()}})}document.getElementById("addAssetBtn").addEventListener("click",()=>{m.push({id:crypto.randomUUID(),source:"fa",faIcon:"star",faStyle:"solid",mode:"count",value:10}),E(),P()});_();[{color:"assetColor",hex:"assetHex",opacity:"assetOpacity"}].forEach(({color:t,hex:s,opacity:n})=>{const i=document.getElementById(t),e=document.getElementById(s),a=document.getElementById(n);!i||!e||!a||(i.addEventListener("input",()=>{e.value=i.value.toUpperCase(),c.updateConfig(t,i.value)}),e.addEventListener("input",o=>{const r=L(o.target.value);r&&(i.value=r,e.value=r.toUpperCase(),c.updateConfig(t,r))}),a.addEventListener("input",()=>{const o=parseInt(a.value)/100;document.getElementById("assetOpacityDisplay").textContent=Math.round(a.value)+"%",c.updateConfig(n,o)}))});document.getElementById("reset").addEventListener("click",()=>{m=[],E(),c.updateConfig("assets",void 0),c.updateConfig("particleAssets",void 0),c.updateConfig("assetColor",void 0),c.updateConfig("assetOpacity",void 0),c.updateConfig("mouseAttractPercentage",void 0),c.updateConfig("mouseAttractAssets",void 0),z();const t=document.getElementById("assetColor"),s=document.getElementById("assetHex"),n=document.getElementById("assetOpacity");t&&(t.value="#a1a1aa"),s&&(s.value="#a1a1aa"),n&&(n.value=100,document.getElementById("assetOpacityDisplay").textContent="100%");const i=document.getElementById("mouseAttractPercentage");i&&(i.value=0,i.parentElement.querySelector(".value-display").textContent="0%"),Object.entries(f).forEach(([o,r])=>{const l=document.getElementById(o);l&&((l.type==="range"||l.type==="number")&&(l.value=r,y(l)),l.type==="checkbox"&&(l.checked=r),l.type==="color"&&(l.value=r),o==="gradientType"&&(l.value=r),o==="gradientFlowAngle"&&(l.value=r,y(l)))}),document.getElementById("backgroundHex").value=f.backgroundColor,document.getElementById("particleHex").value=f.particleColor,document.getElementById("lineHex").value=f.lineColor;const e=document.getElementById("gradientSpin");e&&(e.checked=f.gradientSpin);const a=document.getElementById("gradientFlowAngle");a&&(a.value=f.gradientFlowAngle,y(a)),c.reset(f),$(),D(f.gradientType)});document.getElementById("randomize").addEventListener("click",()=>{const t=Math.floor(Math.random()*200)+50;document.getElementById("particleCount").value=t,y(document.getElementById("particleCount")),c.updateConfig("particleCount",t);const s="#"+Math.floor(Math.random()*16777215).toString(16).padStart(6,"0");document.getElementById("particleColor").value=s,document.getElementById("lineColor").value=s,document.getElementById("particleHex").value=s,document.getElementById("lineHex").value=s,c.updateConfig("particleColor",s),c.updateConfig("lineColor",s);const n={minRadius:Math.random()*4+1,maxRadius:Math.random()*6+4,maxDistance:Math.random()*200+100,moveSpeed:Math.random()*1.5+.2,mouseRadius:Math.random()*200+100,pulseSpeed:Math.random()*.2,depthSpeed:Math.random()*.06+.01,lineOpacity:Math.random()*80+10,particleOpacity:Math.random()*50+50};Object.entries(n).forEach(([i,e])=>{const a=document.getElementById(i);a&&(a.value=e,y(a),c.updateConfig(i,e))})});document.getElementById("copyJson").addEventListener("click",async()=>{const t={...c.config},s=JSON.stringify(t,null,2);try{await navigator.clipboard.writeText(s);const n=document.getElementById("copyJson"),i=n.textContent;n.textContent="Copied!",setTimeout(()=>n.textContent=i,1500)}catch(n){console.error("Copy failed:",n)}});
